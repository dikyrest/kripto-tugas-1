<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo.png" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
    <title>Cipher Mania</title>
  </head>
  <body>
    <div id="root"></div>
    <py-script>
        def vigenere(plaintext, key):
            """Encrypt plaintext using Vigenere cipher with key."""
            # filter out non-alphabetic characters from key
            key = ''.join([char for char in key if char.isalpha()])
            ciphertext = ''
            j = 0
            for i in range(len(plaintext)):
                if plaintext[i].isalpha():
                    if plaintext[i].isupper():
                        ciphertext += shift(plaintext[i], ord(key[j % len(key)].upper()) - ord('A'))
                    else:
                        ciphertext += shift(plaintext[i], ord(key[j % len(key)].lower()) - ord('a'))
                    j += 1
                else:
                    ciphertext += plaintext[i]
            return ciphertext

        def decrypt(ciphertext, key):
            """Decrypt ciphertext using Vigenere cipher with key."""
            # filter out non-alphabetic characters from key
            key = ''.join([char for char in key if char.isalpha()])
            plaintext = ''
            j = 0
            for i in range(len(ciphertext)):
                if ciphertext[i].isalpha():
                    if ciphertext[i].isupper():
                        plaintext += shift(ciphertext[i], -ord(key[j % len(key)].upper()) + ord('A'))
                    else:
                        plaintext += shift(ciphertext[i], -ord(key[j % len(key)].lower()) + ord('a'))
                    j += 1
                else:
                    plaintext += ciphertext[i]
            return plaintext

        def shift(char, n):
            """Shift char by n places."""
            if char.isupper():
                return chr((ord(char) - ord('A') + n) % 26 + ord('A'))
            else:
                return chr((ord(char) - ord('a') + n) % 26 + ord('a'))

        def display_encipher():
            """Display the result of the encryption/decryption."""
            plaintext = js.document.getElementById('plaintext').value
            key = js.document.getElementById('key-enc').value
            ciphertext = vigenere(plaintext, key)
            display(ciphertext, target='result')

        def display_decipher():
            """Display the result of the encryption/decryption."""
            ciphertext = js.document.getElementById('ciphertext').value
            key = js.document.getElementById('key-dec').value
            plaintext = decrypt(ciphertext, key)
            display(plaintext, target='result')
    </py-script>
  </body>
</html>
